<!doctype html>
<title>removing the candidate source</title>
<p>FAIL (script didn't run)</p>
<script>
var v=document.createElement('video');
document.body.appendChild(v); // invokes resource selection
function createSource(src) {
  var source = document.createElement('source');
  source.src = src;
  return source;
}
v.appendChild(createSource('/resources/file.php?file=fail.html&type=video%2Fogg&status=200%20OK&sleep=1'));
</script>
<!-- now resource selection algorithm will continue its sync section -->
<!-- #a is candidate -->
<!-- pointer is between #a and the end of the list -->
<script>
v.removeChild(v.firstChild); // just tests that we don't crash
setTimeout(function() {
  document.querySelector('p').textContent = 'PASS';
  try{top.opener.rr(true)}catch(e){}
}, 2000);
</script>