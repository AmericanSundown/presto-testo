<!doctype html>
<title>loop in object in structured clone</title>
<script src="/resources/jsframework.js"></script>
<script>
test(function() {
  var x = {};
  x.foo = x;
  postMessage(x, '*');
  test(function(e) {
    assertTrue(e.data === e.data.foo, 'e.data === e.data.foo');
  }, window, 'message');
/* 2010-09: spec changed to admit cycles & preserve them in the output.
  assertThrows(function() {
    postMessage(x, '*', []);
  }, [], DOMException, {code:9});
*/
});
</script>

