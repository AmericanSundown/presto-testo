<!-- Test: Executable content with FILE: privilege can be injected
       into JS console and can be used to read other content with
       FILE: privilege

     2003-04-30 / lth

     Reported by Nesumin here: http://www.securityfocus.com/archive/1/319813

     Using opera.postError it is possible to post text to the console
     that is interpreted as a URL and therefore is clickable, but also
     executes a payload of trojan code.  This attack takes advantage
     of the specific code in the console and the way quoting of text
     is (not) done.

     The attack requires a user to click on a strange-looking link in
     the console for the payload to be executed; the payload is
     visible in the link, so the user should be suspicious.  However,
     the payload can be concealed in a containing page, so an attack
     is not completely outlandish.

     This page tests whether the quoting is done correctly to avoid
     this attack.

     -->
<html>

<head>
<title>Console intermediary attack III</title>
</head>

<body>
<p>This page posts one error messages to the JS console.  Click on
it; you should see no alert, but in Opera 7.10 there is an alert.  (Not in
earlier versions of Opera 7.)</p>

<script>
opera.postError("http://&#39;);alert(location.href+&#39;");
</script>

</body>
</html>
